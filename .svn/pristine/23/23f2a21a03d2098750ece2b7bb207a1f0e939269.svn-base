<script type="text/javascript" src="<?php echo base_url()?>themes/Limitless/default/assets/js/plugins/visualization/c3/c3.min.js"></script>

<!-- Project list -->
<div class="panel panel-flat">
    <div class = "row m-10">
        <div class = "row col-md-6 m-10">
<!--            <label class = "text-size-large text-semibold">Select role</label>-->
            <select id="role" name="role" data-placeholder="Select role" class="select">
                <option value="all">All</option>
                <?php foreach ($roles as $key => $r) { ?>
                    <option value="<?php echo str_replace(" ","_",strtolower($r->role_name))?>"><?php echo $r->role_name?></option>
                <?php } ?>
            </select>
        </div>
            <div class = "tab1 all">
                <?php foreach($role as $key => $r) {?>
                <div class = "col-md-6">
                    <div class="panel panel-flat">
                        <div class="panel-heading">
                            <h6 class="panel-title"><?php echo $r->role_name?>
                                <small class = "text-info"><i class = icon-primitive-square></i>Availability</small>
                                <small class = "text-warning"><i class = icon-primitive-square></i> Outstanding Work</small>
                            </h6>
                        </div>

                        <div class="panel-body">
                            <?php foreach($r->resource as $i => $res) {?>
                                <div class="progress">
                                    <div class="progress-bar bg-info" style="width: <?php echo $res->availbility?>%">
                                        <span> <?php echo $res->availbility?>%</span>
                                    </div>

                                    <div class="progress-bar progress-bar-warning" style="width: <?php echo $res->os_work?>%">
                                        <span> <?php echo $res->os_work?>%</span>
                                    </div>
                                </div>
                                <label class = "text-center"><?php echo $res->fullname?></label>
                            <?php } ?>
                        </div>
                    </div>
                </div>
                <?php } ?>
            </div>

            <?php foreach ($role as $i => $p){?>
            <div class = "tab <?php echo $p->code?>">
                    <div class = "col-md-12">
                        <div class="panel panel-flat">
                            <div class="panel-heading">
                                <h6 class="panel-title"><?php echo $p->role_name?>
                                    <small class = "text-info"><i class = icon-primitive-square></i>Availability</small>
                                    <small class = "text-warning"><i class = icon-primitive-square></i> Outstanding Work</small>
                                </h6>
                            </div>

                            <div class="panel-body">
                                <table class="table table-bordered text-nowrap">
                                    <thead>
                                    <tr>
                                        <th rowspan = "2">No</th>
                                        <th rowspan = "2">Name </th>
                                        <th colspan = "2" rowspan = "2">Total Project </th>
                                        <th rowspan = "2">Availability</th>
                                        <th rowspan = "2">Oustanding Work</th>
                                        <?php for ($x = 1; $x <= $p->max_project; $x++) {
                                            echo "<th colspan = '3'>Project ".$x."</th>";
                                        }  ?>
                                    </tr>
                                    <tr>
                                        <?php for ($x = 1; $x <= $p->max_project; $x++) {
                                            echo "<th>Project ID</th>";
                                            echo "<th>Project Name</th>";
                                            echo "<th>Completion</th>";
                                        }  ?>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <?php $no = 1; foreach ($p->resource as $key => $u) { ?>
                                        <tr>
                                            <td><?php echo $no;?></td>
                                            <td><?php echo $u->fullname;?> </td>
                                            <td><?php echo $u->total_project;?></td>
                                            <td><?php for ($x = 0; $x < $u->total_project; $x++) {
                                                    echo "<span class = 'label label-success label-rounded' >".$u->project[$x]->id."</span>";
                                                }  ?></td>
                                            <td><?php echo $u->availbility;?>%</td>
                                            <td><?php echo $u->os_work;?>%</td>
                                            <?php for ($x = 0; $x < $u->total_project; $x++) {
                                                echo "<td>".$u->project[$x]->id."</td>";
                                                echo "<td>".$u->project[$x]->project_name."</td>";
                                                echo "<td>".$u->project[$x]->completion."%</td>";
                                            }  ?>
                                            <?php for ($x = 0; $x < $p->max_project-$u->total_project; $x++) {
                                                echo "<td></td>";
                                                echo "<td></td>";
                                                echo "<td></td>";
                                            }  ?>
                                        </tr>
                                    <?php $no++; } ?>
                                    </tbody>
                                </table>
                                <br/>
                                <?php foreach($p->resource as $i => $res) {?>
                                    <div class="progress">
                                        <div class="progress-bar bg-info" style="width: <?php echo $res->availbility?>%">
                                            <span> <?php echo $res->availbility?>%</span>
                                        </div>

                                        <div class="progress-bar progress-bar-warning" style="width: <?php echo $res->os_work?>%">
                                            <span> <?php echo $res->os_work?>%</span>
                                        </div>
                                    </div>
                                    <label class = "text-center"><?php echo $res->fullname?></label>
                                <?php } ?>
                            </div>
                        </div>
                    </div>
            </div>
            <?php } ?>
        </div>
    </div>
</div>

<style>
    .dataTable{
    border-collapse: collapse;
    }
    .dataTable tbody > tr:first-child > td {
    border-top: none;
        border-top: 1px solid #ddd;
        border-collapse: collapse;
    }
    .table > tbody > tr.border-double > td {
    border-top-width: 3px;
        border-top-style: double;
    }
</style>

<script type="text/javascript">
    $(function(){
        $(".tab1").hide();
        $(".tab").hide();

    });

    $("#role").change(function(){
        console.log($(this).val());
        if($(this).val == 'all'){
            $(".tab1").hide();
            $(".tab").fadeIn('slow');
        } else {
            $(".tab").hide();
            var c = "."+$(this).val();
            $(c).fadeIn('slow');
        }
    });
</script>


